<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link type="text/css" href="./css/caseDetails.css" rel="stylesheet" />
    <link type="text/css" href="./css/header.css" rel="stylesheet" />
    <link type="text/css" href="./css/footer.css" rel="stylesheet" />
    <link href="./css/jquery.bxslider.css" rel="stylesheet" type="text/css">
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="./js/jquery.js"></script>
    <script src="./js/method.js"></script>
    <script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.bxslider.js"></script>
    <script src="./js/iconfont.js"></script>
    <title>产品详情</title>
    <style>
        #icon{
            width: 60px;
            height: 60px;
            vertical-align: -0.15em;
            fill: currentColor;
            overflow: hidden;
        }
    </style>
</head>
<body style="margin:0">
    <div id="app">
        <div class="header">
            <div class="header_center">
                <div class="header_image">
                    <img src="./images/logo2.png" alt="金廷">
                </div>
                <div class="navigation">
                    <div class="navigation-nav">
                        <ul class="navigation-item" id="toubua">
                            <li><a href="index.html">首页</a></li>
                            <li><a href="./case.html" id="active">产品</a></li>
                            <li><a href="./news.html">新闻资讯</a></li>
                            <li><a href="./introduction.html">公司介绍</a></li>
                            <li><a href="./contact.html">联系我们</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="buzhidao">
            <div class="header_content">
                <span class="weizhi">当前位置：首页>装修案例>案例详情</span>
                <div class="img_content">
                    <img :src="url">
                    <div class="content">
                        <h3>{{productName}}</h3>
                        <div class="fuwu" v-for="items in paramsa">
                            <span class="qian">{{items.name}}：</span>
                            <span class="hou">{{items.value}}</span>
                        </div>
                        <div class="price">
                            <span class="money">￥{{price}}</span>
                        </div>
                        <button class="ljzx">立即购买</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="section">
            <div class="left">
                <div class="top">
                    <div class="details">生产流程</div>
                    <div class="slider4">
                        <div class="slide" v-for="item in process"><span>{{item.name}} {{item.equipmentName}}</span><img :src="item.cover" class="tupian"></div>
                    </div>
                </div>
                <div class="top">
                    <div class="details">图文详情</div>
                    <div class="neirong">{{productIntro}}</div>
                </div>
            </div>
            <div class="right">
                <div class="tjal">
                    <img src="./images/fire.png">
                    <span class="tjaltitle">推荐产品</span>
                </div>
                <div class="anliItem" v-for="item in casea">
                    <img :src="item.url">
                    <div class="righta">
                        <h4>{{item.productName}}</h4>
                        <span class="jaigea">￥{{item.price}}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="goTop" id="gotoTop">
        <img src="./images/02.png" alt="">
    </div>
    <!-- 底部 -->
    <div class="footer" id="link">
        <div class="center">
            <div class="left">
                <svg class="icon" aria-hidden="true" id="icon">
                    <use xlink:href="#icon-gerenyonghutouxiang" style="color: #7B818D"></use>
                </svg>
                <span class="time">(9:00-21:00)</span>
                <h3>0571-86390185</h3>
                <span class="qq">QQ联系方式:1523446254</span>
            </div>
            <div class="zhongjian">
                <ul>
                    <li><a href="javascript:;">首 页</a></li>
                    <li><a href="/case.html">案例欣赏</a></li>
                    <li><a href="javascript:;">服务介绍</a></li>
                    <li><a href="./news.html">新闻动态</a></li>
                </ul>
                <ul>
                    <li><a href="./introduction.html">关于我们</a></li>
                    <li><a href="./contact.html">联系我们</a></li>
                    <li><a href="javascript:;">留言板</a></li>
                </ul>
            </div>
            <div class="right">
                <div class="picture">
                    <img src="./images/erweima.jpg" alt="">
                    <span class="guanzhu">关注微信公众号</span>
                </div>
            </div>
            <div class="lianjie">
                <span class="chuanmei">Copyright © 2013 - 2017　faane.com　杭州金廷基业房地产营销策划有限公司　版权所有  备案图标.png苏公网安备 32011202000125号‍</span>
                <div class="youqing">
                    <ul>
                        <li v-for='item in link'><a :href="'http://'+item.www">{{item.name}}</a></li>
                    </ul>
                </div>
                <span class="chuanmei">手机版 | 苏ICP备18005516号</span>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    var serverHost = getServerHosts();
    //获取url中的参数
    function getUrlParam(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
        var r = window.location.search.substr(1).match(reg); //匹配目标参数
        if (r != null) return unescape(r[2]);
        return null; //返回参数值
    }

    //接收URL中的参数booksId
    var pid = getUrlParam('pid');
    console.log('pid:' + pid);
    var app = new Vue({
        el:'#app',
        data:{
            url:'',
            productName:'',
            price:'',
            productIntro:'',
            paramsa:[],
            casea:[],
            process:[]
        },
        methods: {
            findData:function(){
                var that = app;
                $.ajax({
                    url:serverHost + '/products/info/' + pid,
                    type:'get',
                    dataType:"json",
                    success(res){
                        var tupian = res.data.url.split(",")
                        that.url = tupian[0]
                        that.productName = res.data.productName,
                        that.price = res.data.price,
                        that.productIntro = res.data.productIntro,
                        that.paramsa = res.data.productParams
                    }
                })

                //获取生产流程步骤
                $.ajax({
                    url: serverHost + '/productProcess/list',
                    type:'get',
                    dataType:'json',
                    data:{
                        current:1,
                        size:20,
                        pid:pid
                    },
                    success:function(data){
                        that.process = data.data.records
                    }
                })

                //推荐产品
                $.ajax({
                    url:serverHost +'/products/recommend',
                    type:"get",
                    dataType:'json',
                    data:{},
                    success(res){
                        that.casea = res.data
                    }
                })
            }
        }
    })
    app.findData();
</script>
<script>
        var serverHost = getServerHosts();
        var link = new Vue({
            el:'#link',
            data:{
                link:[]
            },
            methods: {
                findData:function(){
                    var that = link;
                    $.ajax({
                        url:serverHost+'/links/list',
                        type:'get',
                        dataType:'json',
                        data:{
                            current:1,
                            size:20
                        },
                        success:function(data){
                            that.link = data.data.records
                            console.log(that.link)
                        }
                    })
                }
            },
        })
        link.findData()
    </script>
<script>
    function gotoTop(minHeight){

        // 定义点击返回顶部图标后向上滚动的动画
        $("#gotoTop").click(
            function(){$('html,body').animate({scrollTop:'0px'},'slow');
        })

        // 获取页面的最小高度，无传入值则默认为600像素
        minHeight? minHeight = minHeight:minHeight = 600;

        // 为窗口的scroll事件绑定处理函数
        $(window).scroll(function(){

            // 获取窗口的滚动条的垂直滚动距离
            var s = $(window).scrollTop();

            // 当窗口的滚动条的垂直距离大于页面的最小高度时，让返回顶部图标渐现，否则渐隐
            if( s > minHeight){
                $("#gotoTop").fadeIn(500);
            }else{
                $("#gotoTop").fadeOut(500);
            };
        });
    };
    gotoTop();
</script>
<script type="text/javascript">
    $(document).ready(function(){
      $('.slider4').bxSlider({
        slideWidth: 150,
        minSlides: 1,
        maxSlides: 5,
        moveSlides: 1,
        startSlide: 0,
        slideMargin: 10
      });
    });
</script>
